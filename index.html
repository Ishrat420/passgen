<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
  <title>Deterministic Password Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h2>Custom Password Generator</h2>

  <label>Website or App Name:</label>
  <input id="website" placeholder="e.g. facebook.com">

  <label>Your Secret / Master Phrase:</label>
  <input id="secret" placeholder="e.g. ChottoMate!42">

  <label>Counter (for rotation):</label>
  <input type="number" id="counter" value="0" min="0">

  <label>Algorithm:</label>
  <select id="algorithm">
    <optgroup label="Secure (Recommended)">
      <option value="PBKDF2-SHA256" selected>PBKDF2-SHA256 (default)</option>
      <option value="Argon2id">Argon2id</option>
      <option value="scrypt">scrypt</option>
    </optgroup>
    <optgroup label="Simple">
      <option value="SHA-256">SHA-256</option>
      <option value="SHA-512">SHA-512</option>
    </optgroup>
  </select>

  <label>Characters to Use from Result:</label>
  <input type="number" id="length" value="16" min="8" max="50">

      <!-- Character Policy Toggle -->
      <div class="toggle-row">
        <label class="switch">
          <input type="checkbox" id="policyToggle" checked>
          <span class="slider"></span>
        </label>
        <label for="policyToggle" class="switch-label">Include upper, lower, digit & symbol</label>
      </div>
      <small id="policyHint" class="hint" style="display:none;">Disabled while Compatibility Mode is on</small>

      <!-- Compatibility Mode Toggle -->
      <div class="toggle-row">
        <label class="switch">
          <input type="checkbox" id="compatToggle">
          <span class="slider"></span>
        </label>
        <label for="compatToggle" class="switch-label">Compatibility Mode (Safe Charset)</label>
      </div>
      <small id="compatHint" class="hint" style="display:none;">Disabled while Character Policy is on</small>


  <button onclick="generate()">Generate Password</button>
  <small id="registryMessage" class="info-msg" style="display:none; color:#777; margin-top:6px; font-style:italic;"></small>

  <div id="result" style="display:none;">
    <span id="password"></span><br>
    <button id="copyBtn" onclick="copyToClipboard()">Copy</button><br>
    <small id="recipeInfo"></small><br>
    <small id="diversityWarning" style="display:none; color:#d33; font-weight:bold;"></small><br>
    <button id="explainBtn" onclick="explainPassword()">üîç Explain My Password</button>
    <div id="explainBox"></div>
  </div>

  <details>
    <summary>Advanced Options ‚öôÔ∏è</summary>
    <label>PBKDF2 Iterations:</label><input type="number" id="iterations" value="100000" min="10000">
    <label>Argon2 Memory (MB):</label><input type="number" id="argonMem" value="64" min="8">
    <label>scrypt N (CPU cost):</label><input type="number" id="scryptN" value="16384" min="1024">
  </details>
  <hr>
  <details id="history" open>
    <summary>üîê Saved Recipes</summary>

    <div class="history-controls">
      <input
        type="text"
        id="searchHistory"
        placeholder="Search by site..."
        class="search-box"
      />
      <div class="history-buttons">
        <button id="exportBtn">Export JSON</button>
        <button id="importBtn">Import JSON</button>
        <button id="clearHistoryBtn">Clear All</button>
      </div>
    </div>

    <ul id="historyList" class="history-list"></ul>
    <small id="storageInfo" style="color:#555;"></small>
  </details>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/argon2-browser/dist/argon2-bundled.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/scrypt-js@3.0.1/scrypt.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
